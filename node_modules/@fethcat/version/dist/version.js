"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.version = void 0;
const extract_1 = require("./extract");
const git_1 = require("./git");
const logger_1 = require("./logger");
const yarn_1 = require("./yarn");
async function version(level, dirs) {
    (0, logger_1.logInfo)(`Bumping ${level} version`);
    await yarn_1.yarn.version(`--${level}`);
    const newVersion = await (0, extract_1.extractVersion)();
    (0, logger_1.logSuccess)(`New version: ${newVersion}`);
    for (const dir of dirs) {
        (0, logger_1.logInfo)(`Applying ${newVersion} in: ${dir}`);
        await yarn_1.yarn.version(`--new-version ${newVersion}`, dir);
    }
    (0, logger_1.logInfo)('Push new version');
    await git_1.git.add(dirs);
    await git_1.git.commit(`v${newVersion}`);
    await git_1.git.tag(`v${newVersion}`);
    await git_1.git.push();
    await git_1.git.push('--tags');
    (0, logger_1.logSuccess)('New version pushed');
}
exports.version = version;
